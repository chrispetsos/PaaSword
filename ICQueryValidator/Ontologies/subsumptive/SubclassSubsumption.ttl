@prefix ex1: <http://www.paasword.eu/security-policy/use-cases/car-park#>.
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix schema: <http://schema.org/> .

@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix pwd: <http://www.paasword.eu/security-policy/seerc/pwd#>.
@prefix otp: <http://www.paasword.eu/security-policy/seerc/otp#>.
@prefix pbe: <http://www.paasword.eu/security-policy/seerc/pbe#>.
@prefix pbdfd: <http://www.paasword.eu/security-policy/seerc/pbdfd#>.
@prefix pac: <http://www.paasword.eu/security-policy/seerc/pac#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix usdl-core: <http://www.linked-usdl.org/ns/usdl-core#>.
@prefix usdl-business-roles: <http://www.linked-usdl.org/ns/usdl-business-roles#>.
@prefix usdl-sec: <http://www.linked-usdl.org/ns/usdl-sec#>.
@prefix orgX: <http://www.paasword.eu/security-policy/orgX#>. 
@prefix gr: <http://purl.org/goodrelations/v1#>. 
@prefix pcm: <http://www.paasword-project.eu/ontologies/casm/2016/05/20#> .
@prefix pdm: <http://www.paasword-project.eu/ontologies/dsm/2016/05/20#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix ppm: <http://www.paasword-project.eu/ontologies/psm/2016/05/20#> .
@prefix pcpm: <http://www.paasword-project.eu/ontologies/cpsm/2016/05/20#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.

# The first two rules are subsumed.
ex1:ABACRule_1 a pac:ABACRule;
	pac:hasControlledObject ex1:PaymentsTable;
	pac:hasAuthorisation pac:positive;
	pac:hasAction ex1:Read;
	pac:hasActor ex1:ParkingEmployee;
	pac:hasContextExpression ex1:expr.

ex1:PaymentsTable a pcm:Relational.

pac:positive a pac:Authorisation.

ex1:Read a ppm:DatastorePermission.

ex1:ParkingEmployee a pcm:Person.

ex1:ABACRule_2 a pac:ABACRule;
	pac:hasControlledObject ex1:PaymentsTable;
	pac:hasAuthorisation pac:positive;
	pac:hasAction ex1:Read;
	pac:hasActor ex1:ParkingEmployee;
	pac:hasContextExpression ex1:expr2.

# This contradicts to rule 1
ex1:ABACRule_3 a pac:ABACRule;
	pac:hasControlledObject ex1:PaymentsTable;
	pac:hasAuthorisation pac:negative;
	pac:hasAction ex1:Read;
	pac:hasActor ex1:ParkingEmployee;
	pac:hasContextExpression ex1:expr.

# This is subsumed by rule 1 and is equivalent to rule 2
ex1:ABACRule_4 a pac:ABACRule;
	pac:hasControlledObject ex1:PaymentsTable;
	pac:hasAuthorisation pac:positive;
	pac:hasAction ex1:Read;
	pac:hasActor ex1:ParkingEmployee;
	pac:hasContextExpression ex1:expr3.


ex1:DepartmentAPaymentsTable a pcm:Relational.
ex1:ParkingSectionAEmployee a pcm:Person.
ex1:ParkingSectionAArea1Employee a pcm:Person.

ex1:Write a ppm:DatastorePermission.
#############################################################################

### Context expression for  ex1:ABACRule_1  and  ex1:ABACRule_2 #############
ex1:expr a pac:ANDContextExpression;
	pac:hasParameter ex1:EmployeeWorkingHours, ex1:expr1 .

ex1:expr2 a pac:ANDContextExpression;
	pac:hasParameter ex1:EmployeeWorkingHours3, ex1:Parking1 ;
	pac:refersTo ex1:ParkingEmployee .

# This is a base expression and has more than one parameters
ex1:expr3 a pac:ContextExpression;
	pac:hasParameter ex1:EmployeeWorkingHours3, ex1:Parking1 ;
	pac:refersTo ex1:ParkingEmployee .

ex1:EmployeeWorkingHours a pcm:DateTimeInterval.
ex1:EmployeeWorkingHours2 a pcm:DateTimeInterval.
ex1:EmployeeWorkingHours3 a pcm:DateTimeInterval.

# Custom alignment to otp namespace
pac:isContainedIn owl:inverseOf otp:subsumes .

ex1:EmployeeWorkingHours pac:subsumes ex1:EmployeeWorkingHours2 .
ex1:EmployeeWorkingHours3 pac:isContainedIn ex1:EmployeeWorkingHours2 .
ex1:PaymentsTable pac:subsumes ex1:DepartmentAPaymentsTable .
ex1:ParkingEmployee pac:subsumes ex1:ParkingSectionAEmployee .
ex1:ParkingSectionAEmployee pac:subsumes ex1:ParkingSectionAArea1Employee .

ex1:expr1 a pac:ORContextExpression;
	pac:hasParameter ex1:Parking1, ex1:Parking2 ;
	pac:refersTo ex1:ParkingEmployee .

ex1:Parking1 a pcm:Point.

ex1:Parking2 a pcm:Point.

pac:contradicts a owl:ObjectProperty, owl:TransitiveProperty .

# alignment to otp namespace for context expressions
otp:TheoremProvingBaseClass a owl:Class .
otp:TheoremProvingParameterProperty a owl:ObjectProperty .
otp:TheoremProvingReferenceProperty a owl:ObjectProperty .
otp:subsumes a owl:ObjectProperty, owl:TransitiveProperty .
otp:ANDTheoremProvingClass a owl:Class .
otp:ORTheoremProvingClass a owl:Class .
otp:XORTheoremProvingClass a owl:Class .
otp:NOTTheoremProvingClass a owl:Class .

pac:ContextExpression rdfs:subClassOf otp:TheoremProvingBaseClass .
pac:hasParameter rdfs:subPropertyOf otp:TheoremProvingParameterProperty .
pac:refersTo rdfs:subPropertyOf otp:TheoremProvingReferenceProperty .
pac:subsumes rdfs:subPropertyOf otp:subsumes .
pac:ANDContextExpression rdfs:subClassOf otp:ANDTheoremProvingClass .
pac:ORContextExpression rdfs:subClassOf otp:ORTheoremProvingClass .
pac:XORContextExpression rdfs:subClassOf otp:XORTheoremProvingClass .
pac:NOTContextExpression rdfs:subClassOf otp:NOTheoremProvingClass .

# alignment to otp namespace for rules
pac:ABACRule rdfs:subClassOf otp:TheoremProvingBaseClass .
pac:hasControlledObject rdfs:subPropertyOf otp:TheoremProvingParameterProperty .
pac:hasAuthorisation rdfs:subPropertyOf otp:TheoremProvingParameterProperty .
pac:hasAction rdfs:subPropertyOf otp:TheoremProvingParameterProperty .
pac:hasActor rdfs:subPropertyOf otp:TheoremProvingParameterProperty .
pac:hasContextExpression rdfs:subPropertyOf otp:TheoremProvingParameterProperty .
pac:ABACRule rdfs:subClassOf otp:ANDTheoremProvingClass .




#################################################################
#    Rules
#################################################################

<urn:swrl#r1> rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

<urn:swrl#r2> rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

<urn:swrl#action> rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

<urn:swrl#actor> rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

<urn:swrl#ce> rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

<urn:swrl#co> rdf:type <http://www.w3.org/2003/11/swrl#Variable> .

[ rdf:type <http://www.w3.org/2003/11/swrl#Imp> ;
   <http://www.w3.org/2003/11/swrl#body> [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                           rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
                                                       <http://www.w3.org/2003/11/swrl#classPredicate> pac:ABACRule ;
                                                       <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1>
                                                     ] ;
                                           rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                      rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#ClassAtom> ;
                                                                  <http://www.w3.org/2003/11/swrl#classPredicate> pac:ABACRule ;
                                                                  <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r2>
                                                                ] ;
                                                      rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                 rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                             <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasControlledObject ;
                                                                             <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1> ;
                                                                             <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#co>
                                                                           ] ;
                                                                 rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                            rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                        <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasControlledObject ;
                                                                                        <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r2> ;
                                                                                        <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#co>
                                                                                      ] ;
                                                                            rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                       rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                   <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasAuthorisation ;
                                                                                                   <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1> ;
                                                                                                   <http://www.w3.org/2003/11/swrl#argument2> pac:positive
                                                                                                 ] ;
                                                                                       rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                  rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                              <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasAuthorisation ;
                                                                                                              <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r2> ;
                                                                                                              <http://www.w3.org/2003/11/swrl#argument2> pac:negative
                                                                                                            ] ;
                                                                                                  rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                             rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                                         <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasAction ;
                                                                                                                         <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1> ;
                                                                                                                         <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#action>
                                                                                                                       ] ;
                                                                                                             rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                                        rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                                                    <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasAction ;
                                                                                                                                    <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r2> ;
                                                                                                                                    <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#action>
                                                                                                                                  ] ;
                                                                                                                        rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                                                   rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                                                               <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasActor ;
                                                                                                                                               <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1> ;
                                                                                                                                               <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#actor>
                                                                                                                                             ] ;
                                                                                                                                   rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                                                              rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                                                                          <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasActor ;
                                                                                                                                                          <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r2> ;
                                                                                                                                                          <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#actor>
                                                                                                                                                        ] ;
                                                                                                                                              rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                                                                         rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                                                                                     <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasContextExpression ;
                                                                                                                                                                     <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1> ;
                                                                                                                                                                     <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#ce>
                                                                                                                                                                   ] ;
                                                                                                                                                         rdf:rest [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                                                                                                                                                    rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                                                                                                                                                <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:hasContextExpression ;
                                                                                                                                                                                <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r2> ;
                                                                                                                                                                                <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#ce>
                                                                                                                                                                              ] ;
                                                                                                                                                                    rdf:rest rdf:nil
                                                                                                                                                                  ]
                                                                                                                                                       ]
                                                                                                                                            ]
                                                                                                                                 ]
                                                                                                                      ]
                                                                                                           ]
                                                                                                ]
                                                                                     ]
                                                                          ]
                                                               ]
                                                    ]
                                         ] ;
   <http://www.w3.org/2003/11/swrl#head> [ rdf:type <http://www.w3.org/2003/11/swrl#AtomList> ;
                                           rdf:first [ rdf:type <http://www.w3.org/2003/11/swrl#IndividualPropertyAtom> ;
                                                       <http://www.w3.org/2003/11/swrl#propertyPredicate> pac:contradicts ;
                                                       <http://www.w3.org/2003/11/swrl#argument1> <urn:swrl#r1> ;
                                                       <http://www.w3.org/2003/11/swrl#argument2> <urn:swrl#r2>
                                                     ] ;
                                           rdf:rest rdf:nil
                                         ]
 ] .
